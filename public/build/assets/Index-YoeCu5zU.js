import{r as z,p as y,c as v,o as n,w as u,a as e,i as f,u as o,j as c,k as d,s as T,g as U,v as G,b,e as g,t as l,F as Y,m as I,y as h,l as x}from"./app-wKfORXs7.js";import{_ as R}from"./AdminLayout-CUjoMrlW.js";import{_ as k}from"./VueSelect.vue_vue_type_script_setup_true_lang-Dkl_tayn.js";import{r as m}from"./route-BVPoXIPw.js";import{S as w}from"./sweetalert2.esm.all-DGhwgajj.js";import"./sidebar.esm-j-ERbOgr.js";const q={class:"space-y-6"},J={class:"flex justify-between items-center mb-8"},Q={class:"bg-white p-6 rounded-xl shadow-md ring-1 ring-gray-100 mb-8"},W={class:"flex items-center justify-between mb-6"},X={class:"flex space-x-3"},Z=["disabled"],ee={class:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-5"},te={class:"space-y-2"},se={class:"relative"},re={class:"space-y-2"},ae={class:"space-y-2"},ie={class:"space-y-2"},ne={class:"bg-white rounded-xl shadow-md ring-1 ring-gray-100"},oe={class:"px-6 py-4 border-b border-gray-200"},le={class:"flex items-center justify-between"},de={class:"text-sm text-gray-500 mt-1"},ue={class:"overflow-x-auto"},ce={class:"min-w-full divide-y divide-gray-200"},ge={class:"bg-white divide-y divide-gray-200"},me={class:"px-6 py-4 whitespace-nowrap"},pe={class:"text-sm font-medium text-gray-900"},fe={class:"text-sm text-gray-500"},xe={class:"px-6 py-4 whitespace-nowrap"},ve={class:"text-sm text-gray-900"},be={class:"px-6 py-4 whitespace-nowrap"},he={class:"px-6 py-4 whitespace-nowrap"},ye={class:"text-sm text-gray-900"},ke={class:"px-6 py-4 whitespace-nowrap text-sm text-gray-500"},we={class:"px-6 py-4 whitespace-nowrap text-sm font-medium"},_e={class:"flex items-center space-x-2"},Ve=["onClick"],Be=["onClick"],Ce=["onClick"],Se={key:0,class:"bg-white px-4 py-3 border-t border-gray-200 sm:px-6"},Pe={class:"flex items-center justify-between"},je={class:"flex-1 flex justify-between sm:hidden"},De={class:"hidden sm:flex-1 sm:flex sm:items-center sm:justify-between"},Te={class:"text-sm text-gray-700"},Ae={class:"relative z-0 inline-flex rounded-md shadow-sm -space-x-px"},Oe={__name:"Index",props:{versions:{type:Object,default:()=>({})},skpdList:{type:Array,default:()=>[]},knowledgeList:{type:Array,default:()=>[]},filters:{type:Object,default:()=>({})},user:{type:Object,default:()=>({})}},setup(a){const p=a,i=z({search:p.filters.search||"",status:p.filters.status||"",skpd_id:p.filters.skpd_id||"",knowledge_id:p.filters.knowledge_id||""}),A=[{value:"",label:"Semua Status"},{value:"draft",label:"Draft"},{value:"published",label:"Published"},{value:"archived",label:"Archived"},{value:"pending_verification",label:"Pending Verification"},{value:"verified",label:"Verified"},{value:"rejected",label:"Rejected"}],F=y(()=>[{value:"",label:"Semua SKPD"},...p.skpdList.map(r=>({value:r.id,label:r.nama_skpd}))]),L=y(()=>[{value:"",label:"Semua Pengetahuan"},...p.knowledgeList.map(r=>({value:r.id,label:r.title}))]),_=y(()=>i.value.search||i.value.status||i.value.skpd_id||i.value.knowledge_id);function V(){h.get(m("admin.knowledge-versions.index"),i.value,{preserveState:!0,preserveScroll:!0})}function M(){i.value={search:"",status:"",skpd_id:"",knowledge_id:""},V()}function E(r){return{draft:"bg-gray-100 text-gray-800",published:"bg-green-100 text-green-800",archived:"bg-yellow-100 text-yellow-800",pending_verification:"bg-blue-100 text-blue-800",verified:"bg-purple-100 text-purple-800",rejected:"bg-red-100 text-red-800"}[r]||"bg-gray-100 text-gray-800"}function K(r){return{draft:"Draft",published:"Published",archived:"Archived",pending_verification:"Pending Verification",verified:"Verified",rejected:"Rejected"}[r]||r}function N(r){return new Date(r).toLocaleDateString("id-ID",{year:"numeric",month:"short",day:"numeric"})}function O(r){w.fire({title:"Publish Versi?",text:"Versi ini akan dipublikasikan dan dapat diakses publik.",icon:"question",showCancelButton:!0,confirmButtonColor:"#10B981",cancelButtonColor:"#6B7280",confirmButtonText:"Ya, Publish!",cancelButtonText:"Batal"}).then(t=>{t.isConfirmed&&h.post(m("admin.knowledge-versions.publish",r),{},{onSuccess:()=>{x.success("Versi berhasil dipublikasikan!")},onError:()=>{x.error("Gagal mempublikasikan versi!")}})})}function H(r){w.fire({title:"Archive Versi?",text:"Versi ini akan diarsipkan dan tidak dapat diakses publik.",icon:"warning",showCancelButton:!0,confirmButtonColor:"#F59E0B",cancelButtonColor:"#6B7280",confirmButtonText:"Ya, Archive!",cancelButtonText:"Batal"}).then(t=>{t.isConfirmed&&h.post(m("admin.knowledge-versions.archive",r),{},{onSuccess:()=>{x.success("Versi berhasil diarsipkan!")},onError:()=>{x.error("Gagal mengarsipkan versi!")}})})}function $(r){w.fire({title:"Hapus Versi?",text:"Data versi akan dihapus permanen dan tidak dapat dikembalikan.",icon:"warning",showCancelButton:!0,confirmButtonColor:"#EF4444",cancelButtonColor:"#6B7280",confirmButtonText:"Ya, Hapus!",cancelButtonText:"Batal"}).then(t=>{t.isConfirmed&&h.delete(m("admin.knowledge-versions.destroy",r),{onSuccess:()=>{x.success("Versi berhasil dihapus!")},onError:()=>{x.error("Gagal menghapus versi!")}})})}return(r,t)=>(n(),v(R,{"page-title":"Knowledge Version Management",user:a.user},{default:u(()=>{var B,C,S;return[e("div",q,[e("div",J,[t[5]||(t[5]=e("div",null,[e("h1",{class:"text-3xl font-bold text-gray-900 tracking-tight"},"Manajemen Versi Pengetahuan"),e("p",{class:"text-gray-600 mt-1"},"Kelola dan atur semua versi pengetahuan dalam sistem")],-1)),f(o(c),{href:o(m)("admin.knowledge-versions.create"),class:"inline-flex items-center px-4 py-2 border border-transparent text-sm font-semibold rounded-lg text-white bg-brand-700 hover:bg-brand-800 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-brand-500 shadow-sm"},{default:u(()=>t[4]||(t[4]=[e("svg",{class:"w-5 h-5 mr-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M12 4v16m8-8H4"})],-1),d(" Tambah Versi ",-1)])),_:1,__:[4]},8,["href"])]),e("div",Q,[e("div",W,[t[8]||(t[8]=e("div",null,[e("h3",{class:"text-lg font-semibold text-gray-900"},"Filter Data"),e("p",{class:"text-sm text-gray-500 mt-1"},"Saring data berdasarkan kriteria yang diinginkan")],-1)),e("div",X,[e("button",{onClick:V,class:"inline-flex items-center px-4 py-2 text-sm font-semibold text-white bg-brand-700 border border-transparent rounded-lg hover:bg-brand-800 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-brand-500 transition-all duration-200 shadow-sm"},t[6]||(t[6]=[e("svg",{class:"w-4 h-4 mr-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M3 4a1 1 0 011-1h16a1 1 0 011 1v2.586a1 1 0 01-.293.707l-6.414 6.414a1 1 0 00-.293.707V17l-4 4v-6.586a1 1 0 00-.293-.707L3.293 7.207A1 1 0 013 6.5V4z"})],-1),d(" Terapkan Filter ",-1)])),e("button",{onClick:M,disabled:!_.value,class:T(["inline-flex items-center px-4 py-2 text-sm font-medium rounded-lg border transition-all duration-200",_.value?"text-gray-600 bg-gray-50 border-gray-300 hover:bg-gray-100 hover:text-gray-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-gray-500 shadow-sm":"text-gray-400 bg-gray-100 border-gray-200 cursor-not-allowed"])},t[7]||(t[7]=[e("svg",{class:"w-4 h-4 mr-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M6 18L18 6M6 6l12 12"})],-1),d(" Hapus Filter ",-1)]),10,Z)])]),e("div",ee,[e("div",te,[t[10]||(t[10]=e("label",{class:"block text-sm font-medium text-gray-700"},"Cari",-1)),e("div",se,[t[9]||(t[9]=e("div",{class:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none"},[e("svg",{class:"h-5 w-5 text-gray-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"})])],-1)),U(e("input",{"onUpdate:modelValue":t[0]||(t[0]=s=>i.value.search=s),type:"text",placeholder:"Cari judul atau konten...",class:"w-full pl-10 pr-3 py-2.5 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-brand-500 focus:border-brand-500 hover:border-gray-400 transition-colors duration-200"},null,512),[[G,i.value.search]])])]),e("div",re,[t[11]||(t[11]=e("label",{class:"block text-sm font-medium text-gray-700"},"Status",-1)),f(k,{modelValue:i.value.status,"onUpdate:modelValue":t[1]||(t[1]=s=>i.value.status=s),options:A,placeholder:"Pilih Status..."},null,8,["modelValue"])]),e("div",ae,[t[12]||(t[12]=e("label",{class:"block text-sm font-medium text-gray-700"},"SKPD",-1)),f(k,{modelValue:i.value.skpd_id,"onUpdate:modelValue":t[2]||(t[2]=s=>i.value.skpd_id=s),options:F.value,placeholder:"Pilih SKPD..."},null,8,["modelValue","options"])]),e("div",ie,[t[13]||(t[13]=e("label",{class:"block text-sm font-medium text-gray-700"},"Pengetahuan",-1)),f(k,{modelValue:i.value.knowledge_id,"onUpdate:modelValue":t[3]||(t[3]=s=>i.value.knowledge_id=s),options:L.value,placeholder:"Pilih Pengetahuan..."},null,8,["modelValue","options"])])])]),e("div",ne,[e("div",oe,[e("div",le,[e("div",null,[t[14]||(t[14]=e("h3",{class:"text-lg font-semibold text-gray-900"},"Daftar Versi Pengetahuan",-1)),e("p",de,"Total "+l(((B=a.versions)==null?void 0:B.total)||0)+" versi ditemukan",1)])])]),e("div",ue,[e("table",ce,[t[17]||(t[17]=e("thead",{class:"bg-gray-50"},[e("tr",null,[e("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"},"Versi"),e("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"},"Pengetahuan"),e("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"},"Status"),e("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"},"SKPD"),e("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"},"Tanggal"),e("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"},"Aksi")])],-1)),e("tbody",ge,[(n(!0),b(Y,null,I((C=a.versions)==null?void 0:C.data,s=>{var P,j;return n(),b("tr",{key:s.id,class:"hover:bg-gray-50"},[e("td",me,[e("div",pe,"v"+l(s.version_number),1),e("div",fe,l(s.title),1)]),e("td",xe,[e("div",ve,l((P=s.knowledge)==null?void 0:P.title),1)]),e("td",be,[e("span",{class:T([E(s.status),"inline-flex px-2 py-1 text-xs font-semibold rounded-full"])},l(K(s.status)),3)]),e("td",he,[e("div",ye,l((j=s.skpd)==null?void 0:j.nama_skpd),1)]),e("td",ke,l(N(s.created_at)),1),e("td",we,[e("div",_e,[f(o(c),{href:o(m)("admin.knowledge-versions.show",s.id),class:"text-brand-600 hover:text-brand-900"},{default:u(()=>t[15]||(t[15]=[d(" Lihat ",-1)])),_:2,__:[15]},1032,["href"]),f(o(c),{href:o(m)("admin.knowledge-versions.edit",s.id),class:"text-indigo-600 hover:text-indigo-900"},{default:u(()=>t[16]||(t[16]=[d(" Edit ",-1)])),_:2,__:[16]},1032,["href"]),s.status==="draft"?(n(),b("button",{key:0,onClick:D=>O(s.id),class:"text-green-600 hover:text-green-900"}," Publish ",8,Ve)):g("",!0),s.status==="published"?(n(),b("button",{key:1,onClick:D=>H(s.id),class:"text-yellow-600 hover:text-yellow-900"}," Archive ",8,Be)):g("",!0),e("button",{onClick:D=>$(s.id),class:"text-red-600 hover:text-red-900"}," Hapus ",8,Ce)])])])}),128))])])]),((S=a.versions)==null?void 0:S.last_page)>1?(n(),b("div",Se,[e("div",Pe,[e("div",je,[a.versions.prev_page_url?(n(),v(o(c),{key:0,href:a.versions.prev_page_url,class:"relative inline-flex items-center px-4 py-2 border border-gray-300 text-sm font-medium rounded-md text-gray-700 bg-white hover:bg-gray-50"},{default:u(()=>t[18]||(t[18]=[d(" Previous ",-1)])),_:1,__:[18]},8,["href"])):g("",!0),a.versions.next_page_url?(n(),v(o(c),{key:1,href:a.versions.next_page_url,class:"ml-3 relative inline-flex items-center px-4 py-2 border border-gray-300 text-sm font-medium rounded-md text-gray-700 bg-white hover:bg-gray-50"},{default:u(()=>t[19]||(t[19]=[d(" Next ",-1)])),_:1,__:[19]},8,["href"])):g("",!0)]),e("div",De,[e("div",null,[e("p",Te," Showing "+l(a.versions.from)+" to "+l(a.versions.to)+" of "+l(a.versions.total)+" results ",1)]),e("div",null,[e("nav",Ae,[a.versions.prev_page_url?(n(),v(o(c),{key:0,href:a.versions.prev_page_url,class:"relative inline-flex items-center px-2 py-2 rounded-l-md border border-gray-300 bg-white text-sm font-medium text-gray-500 hover:bg-gray-50"},{default:u(()=>t[20]||(t[20]=[d(" Previous ",-1)])),_:1,__:[20]},8,["href"])):g("",!0),a.versions.next_page_url?(n(),v(o(c),{key:1,href:a.versions.next_page_url,class:"relative inline-flex items-center px-2 py-2 rounded-r-md border border-gray-300 bg-white text-sm font-medium text-gray-500 hover:bg-gray-50"},{default:u(()=>t[21]||(t[21]=[d(" Next ",-1)])),_:1,__:[21]},8,["href"])):g("",!0)])])])])])):g("",!0)])])]}),_:1},8,["user"]))}};export{Oe as default};
