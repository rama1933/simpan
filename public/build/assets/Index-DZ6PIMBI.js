import{d as N,r as y,n as f,A as T,c as R,o as d,w as v,a as t,i as h,b as u,e as c,u as V,j as i,q as j,g as U,v as O,t as n,F as I,k as q,h as A}from"./app-FastzsqD.js";import{_ as G}from"./AdminLayout-jdP02O4L.js";import{_ as J}from"./VueTable.vue_vue_type_script_setup_true_lang-lpF_N3Hh.js";import{_ as S}from"./VueSelect.vue_vue_type_script_setup_true_lang-Dw15n5_q.js";import{r as _}from"./route-BVPoXIPw.js";import"./sidebar.esm-BzhdfNBg.js";const Q={class:"flex justify-between items-center mb-8"},W=["href"],X={class:"bg-white p-6 rounded-xl shadow-md ring-1 ring-gray-100 mb-8"},Y={class:"flex items-center justify-between mb-6"},Z={class:"flex space-x-3"},ee=["disabled"],te={class:"grid grid-cols-1 md:grid-cols-3 lg:grid-cols-4 gap-5"},se={class:"space-y-2"},ae={class:"relative"},re={class:"space-y-2"},le={class:"space-y-2"},ne={key:0,class:"mt-4 pt-4 border-t border-gray-100"},oe={class:"flex items-center space-x-2"},ie={class:"flex flex-wrap gap-2"},de={key:0,class:"inline-flex items-center px-2.5 py-1 rounded-full text-xs font-medium bg-brand-100 text-brand-800"},ue={key:1,class:"inline-flex items-center px-2.5 py-1 rounded-full text-xs font-medium bg-green-100 text-green-800"},pe={key:2,class:"inline-flex items-center px-2.5 py-1 rounded-full text-xs font-medium bg-purple-100 text-purple-800"},ce={key:1,class:"mt-4 text-center"},me={class:"flex items-center"},ge={class:"h-8 w-8 mr-3 rounded-full bg-gray-200 flex items-center justify-center text-gray-600 font-semibold"},fe={class:"text-sm font-medium text-gray-900"},ve={class:"text-sm text-gray-500"},xe={class:"flex flex-wrap gap-1"},be={class:"text-sm text-gray-700"},ye={class:"flex items-center space-x-3"},ke=["href"],he=["onClick"],_e={key:0,class:"bg-white/80 backdrop-blur px-4 py-3 flex items-center justify-between border-t border-gray-200 sm:px-6 rounded-b-xl mt-4"},we={class:"flex flex-1 justify-between sm:hidden"},Ce=["disabled"],Me=["disabled"],De={class:"hidden sm:flex sm:flex-1 sm:items-center sm:justify-between"},Pe={class:"text-sm text-gray-700"},Ve={class:"font-medium"},je={class:"font-medium"},Ae={class:"font-medium"},Se={class:"isolate inline-flex -space-x-px rounded-md shadow-sm","aria-label":"Pagination"},$e=["disabled"],Be={class:"relative inline-flex items-center px-4 py-2 text-sm font-semibold text-gray-900 ring-1 ring-inset ring-gray-300 focus:z-20"},ze=["disabled"],Te=N({__name:"Index",props:{users:{default:()=>({data:[],links:[]})},filters:{default:()=>({})},roles:{default:()=>[]},skpds:{default:()=>[]},user:{default:null}},setup($){var M,D,P;const p=$,x=y(p.users||{data:[],links:[]}),r=y({search:((M=p.filters)==null?void 0:M.search)||"",role:((D=p.filters)==null?void 0:D.role)||"",skpd_id:((P=p.filters)==null?void 0:P.skpd_id)||""}),w=f(()=>{const s=x.value;return s?Array.isArray(s.data)?s.data:s.data&&Array.isArray(s.data.data)?s.data.data:[]:[]}),l=f(()=>{const s=x.value,e=Array.isArray(s==null?void 0:s.data)?s:s==null?void 0:s.data;return{from:(e==null?void 0:e.from)??0,to:(e==null?void 0:e.to)??0,total:(e==null?void 0:e.total)??0,prev_page_url:(e==null?void 0:e.prev_page_url)??null,next_page_url:(e==null?void 0:e.next_page_url)??null,current_page:(e==null?void 0:e.current_page)??1}}),B=y([{key:"user",label:"USER",type:"custom"},{key:"roles",label:"ROLE",type:"custom"},{key:"skpd",label:"SKPD",type:"custom"},{key:"actions",label:"AKSI",type:"custom"}]),z=f(()=>{const s=(p.roles||[]).map(e=>({value:e.name,label:e.name}));return[{value:"",label:"Semua Role"},...s]}),C=f(()=>[{value:"",label:"Semua SKPD"},...(p.skpds||[]).map(s=>({value:s.id,label:s.nama_skpd}))]),m=f(()=>Object.values(r.value).some(s=>s!=="")),k=y(!1),g=async(s,e)=>{k.value=!0;try{const a=e?`/api/users/filter?page=${e}`:"/api/users/filter",o=await A.post(a,s);o.data.users&&o.data.users.success?x.value=o.data.users.data:x.value={data:[],links:[]}}catch{}finally{k.value=!1}},b=s=>{!s||s<1||g(r.value,s)},F=async()=>{await g({search:"",role:"",skpd_id:""})},H=()=>g(r.value,1),K=()=>{r.value={search:"",role:"",skpd_id:""},g(r.value,1)},E=s=>{const e=(C.value||[]).find(a=>a.value===s);return e?e.label:s},L=async s=>{if(!(!(s!=null&&s.id)||!confirm("Hapus pengguna ini?")))try{const a=_("users.destroy",s.id)||`/users/${s.id}`;await A.post(a,{_method:"DELETE"}),g(r.value,1)}catch{alert("Gagal menghapus pengguna")}};return T(()=>{F()}),(s,e)=>(d(),R(G,{"page-title":"User Management",user:s.user},{default:v(()=>[t("div",Q,[e[11]||(e[11]=t("div",null,[t("h1",{class:"text-3xl font-bold text-gray-900 tracking-tight"},"Manajemen Pengguna"),t("p",{class:"text-gray-600 mt-1"},"Kelola dan atur semua pengguna dalam sistem")],-1)),t("a",{href:V(_)("users.create"),class:"inline-flex items-center px-4 py-2 border border-transparent text-sm font-semibold rounded-lg text-white bg-brand-700 hover:bg-brand-800 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-brand-500 shadow-sm"},e[10]||(e[10]=[t("svg",{class:"w-5 h-5 mr-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M12 4v16m8-8H4"})],-1),i(" Tambah Pengguna ",-1)]),8,W)]),t("div",X,[t("div",Y,[e[14]||(e[14]=t("div",null,[t("h3",{class:"text-lg font-semibold text-gray-900"},"Filter Data"),t("p",{class:"text-sm text-gray-500 mt-1"},"Saring data berdasarkan kriteria yang diinginkan")],-1)),t("div",Z,[t("button",{onClick:H,class:"inline-flex items-center px-4 py-2 text-sm font-semibold text-white bg-brand-700 border border-transparent rounded-lg hover:bg-brand-800 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-brand-500 transition-all duration-200 shadow-sm"},e[12]||(e[12]=[t("svg",{class:"w-4 h-4 mr-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M3 4a1 1 0 011-1h16a1 1 0 011 1v2.586a1 1 0 01-.293.707l-6.414 6.414a1 1 0 00-.293.707V17l-4 4v-6.586a1 1 0 00-.293-.707L3.293 7.207A1 1 0 013 6.5V4z"})],-1),i(" Terapkan Filter ",-1)])),t("button",{onClick:K,disabled:!m.value,class:j(["inline-flex items-center px-4 py-2 text-sm font-medium rounded-lg border transition-all duration-200",m.value?"text-gray-600 bg-gray-50 border-gray-300 hover:bg-gray-100 hover:text-gray-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-gray-500 shadow-sm":"text-gray-400 bg-gray-100 border-gray-200 cursor-not-allowed"])},e[13]||(e[13]=[t("svg",{class:"w-4 h-4 mr-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M6 18L18 6M6 6l12 12"})],-1),i(" Clear Filters ",-1)]),10,ee)])]),t("div",te,[t("div",se,[e[16]||(e[16]=t("label",{class:"block text-sm font-medium text-gray-700"},"Cari",-1)),t("div",ae,[e[15]||(e[15]=t("div",{class:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none"},[t("svg",{class:"h-5 w-5 text-gray-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"})])],-1)),U(t("input",{"onUpdate:modelValue":e[0]||(e[0]=a=>r.value.search=a),type:"text",placeholder:"Cari nama atau email...",class:"w-full pl-10 pr-3 py-2.5 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-brand-500 focus:border-brand-500 hover:border-gray-400 transition-colors duration-200"},null,512),[[O,r.value.search]])])]),t("div",re,[e[17]||(e[17]=t("label",{class:"block text-sm font-medium text-gray-700"},"Role",-1)),h(S,{modelValue:r.value.role,"onUpdate:modelValue":e[1]||(e[1]=a=>r.value.role=a),options:z.value,placeholder:"Pilih Role..."},null,8,["modelValue","options"])]),t("div",le,[e[18]||(e[18]=t("label",{class:"block text-sm font-medium text-gray-700"},"SKPD",-1)),h(S,{modelValue:r.value.skpd_id,"onUpdate:modelValue":e[2]||(e[2]=a=>r.value.skpd_id=a),options:C.value,placeholder:"Pilih SKPD..."},null,8,["modelValue","options"])])]),m.value?(d(),u("div",ne,[t("div",oe,[e[19]||(e[19]=t("span",{class:"text-sm text-gray-500"},"Filter aktif:",-1)),t("div",ie,[r.value.search?(d(),u("span",de,[i(" Search: "+n(r.value.search)+" ",1),t("button",{onClick:e[3]||(e[3]=a=>r.value.search=""),class:"ml-1.5 text-brand-700 hover:text-brand-900"},"×")])):c("",!0),r.value.role?(d(),u("span",ue,[i(" Role: "+n(r.value.role)+" ",1),t("button",{onClick:e[4]||(e[4]=a=>r.value.role=""),class:"ml-1.5 text-green-600 hover:text-green-800"},"×")])):c("",!0),r.value.skpd_id?(d(),u("span",pe,[i(" SKPD: "+n(E(r.value.skpd_id))+" ",1),t("button",{onClick:e[5]||(e[5]=a=>r.value.skpd_id=""),class:"ml-1.5 text-purple-600 hover:text-purple-800"},"×")])):c("",!0)])])])):c("",!0),k.value?(d(),u("div",ce,e[20]||(e[20]=[t("div",{class:"inline-flex items-center px-4 py-2 text-sm text-brand-700 bg-brand-50 rounded-lg border border-brand-200"},[t("svg",{class:"animate-spin -ml-1 mr-3 h-5 w-5 text-brand-700",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24"},[t("circle",{class:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor","stroke-width":"4"}),t("path",{class:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]),i(" Memuat data... ")],-1)]))):c("",!0)]),h(J,{data:w.value,columns:B.value,title:"Daftar Pengguna","empty-message":m.value?"Data tidak ditemukan":"Tidak ada data","empty-description":m.value?"Coba ubah filter atau hapus beberapa filter untuk melihat data yang tersedia.":"Belum ada pengguna yang ditambahkan."},{user:v(({item:a})=>[t("div",me,[t("div",ge,n((a.name||"?").charAt(0).toUpperCase()),1),t("div",null,[t("div",fe,n(a.name),1),t("div",ve,n(a.email),1)])])]),roles:v(({item:a})=>[t("div",xe,[(d(!0),u(I,null,q(a.roles||[],o=>(d(),u("span",{key:o.id,class:j(["inline-flex items-center px-2 py-0.5 rounded-full text-xs font-medium",o.name==="Admin"?"bg-red-100 text-red-800":"bg-brand-100 text-brand-800"])},n(o.name),3))),128))])]),skpd:v(({item:a})=>{var o;return[t("span",be,n(((o=a.skpd)==null?void 0:o.nama_skpd)||"-"),1)]}),actions:v(({item:a})=>[t("div",ye,[t("a",{href:V(_)("users.edit",a.id),class:"text-brand-700 hover:text-brand-900"},"Edit",8,ke),t("button",{onClick:o=>L(a),class:"text-red-600 hover:text-red-800"},"Hapus",8,he)])]),_:1},8,["data","columns","empty-message","empty-description"]),w.value.length>0?(d(),u("div",_e,[t("div",we,[t("button",{onClick:e[6]||(e[6]=a=>b(l.value.current_page-1)),disabled:!l.value.prev_page_url,class:"relative inline-flex items-center rounded-md border border-gray-300 bg-white px-4 py-2 text-sm font-medium text-gray-700 hover:bg-gray-50 disabled:opacity-50 disabled:cursor-not-allowed"},"Previous",8,Ce),t("button",{onClick:e[7]||(e[7]=a=>b(l.value.current_page+1)),disabled:!l.value.next_page_url,class:"relative ml-3 inline-flex items-center rounded-md border border-gray-300 bg-white px-4 py-2 text-sm font-medium text-gray-700 hover:bg-gray-50 disabled:opacity-50 disabled:cursor-not-allowed"},"Next",8,Me)]),t("div",De,[t("div",null,[t("p",Pe,[e[21]||(e[21]=i(" Menampilkan ",-1)),t("span",Ve,n(l.value.from),1),e[22]||(e[22]=i(" hingga ",-1)),t("span",je,n(l.value.to),1),e[23]||(e[23]=i(" dari ",-1)),t("span",Ae,n(l.value.total),1),e[24]||(e[24]=i(" hasil ",-1))])]),t("div",null,[t("nav",Se,[t("button",{onClick:e[8]||(e[8]=a=>b(l.value.current_page-1)),disabled:!l.value.prev_page_url,class:"relative inline-flex items-center rounded-l-md px-2 py-2 text-gray-400 ring-1 ring-inset ring-gray-300 hover:bg-gray-50 focus:z-20 disabled:opacity-50 disabled:cursor-not-allowed"},e[25]||(e[25]=[t("span",{class:"sr-only"},"Previous",-1),t("svg",{class:"h-5 w-5",viewBox:"0 0 20 20",fill:"currentColor","aria-hidden":"true"},[t("path",{"fill-rule":"evenodd",d:"M12.79 5.23a.75.75 0 01-.02 1.06L9.525 9.25H15a.75.75 0 010 1.5H9.525l3.245 2.96a.75.75 0 11-1.04 1.08l-4.5-4.1a.75.75 0 010-1.08l4.5-4.1a.75.75 0 011.06.02z","clip-rule":"evenodd"})],-1)]),8,$e),t("span",Be,"Halaman "+n(l.value.current_page),1),t("button",{onClick:e[9]||(e[9]=a=>b(l.value.current_page+1)),disabled:!l.value.next_page_url,class:"relative inline-flex items-center rounded-r-md px-2 py-2 text-gray-400 ring-1 ring-inset ring-gray-300 hover:bg-gray-50 focus:z-20 disabled:opacity-50 disabled:cursor-not-allowed"},e[26]||(e[26]=[t("span",{class:"sr-only"},"Next",-1),t("svg",{class:"h-5 w-5",viewBox:"0 0 20 20",fill:"currentColor","aria-hidden":"true"},[t("path",{"fill-rule":"evenodd",d:"M7.21 14.77a.75.75 0 01.02-1.06l3.245-2.96H5a.75.75 0 010-1.5h5.475l-3.245-2.96a.75.75 0 111.04-1.08l4.5 4.1a.75.75 0 010 1.08l-4.5 4.1a.75.75 0 01-1.06-.02z","clip-rule":"evenodd"})],-1)]),8,ze)])])])])):c("",!0)]),_:1},8,["user"]))}});export{Te as default};
