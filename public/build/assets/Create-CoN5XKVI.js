import{r as f,n as T,c as A,o as n,w,a as t,b as l,e as i,t as d,i as y,u as k,l as j,f as h,j as p,q as u,g as c,v,F as G,k as J,y as K,x as _}from"./app-Csu41_Kp.js";import{_ as I}from"./AdminLayout-BSzZtYi4.js";import{_ as P}from"./VueSelect.vue_vue_type_script_setup_true_lang-CDBjgkUk.js";import{r as V}from"./route-B4Jpo0AN.js";import"./sidebar.esm-CutvFG-v.js";const q={class:"min-h-screen bg-gray-50"},H={class:"w-full mx-auto py-6 px-6"},Q={class:"px-0"},R={key:0,class:"mb-4"},W={class:"rounded-md bg-green-50 p-4 border border-green-200"},X={class:"text-sm font-medium text-green-800"},Y={class:"mb-6 flex items-center justify-between"},Z={class:"grid grid-cols-1 gap-6"},ee={class:"space-y-6"},te={class:"bg-white shadow rounded-lg p-6"},se={class:"space-y-6"},re={key:0,class:"mt-1 text-sm text-red-600"},ae={key:0,class:"mt-1 text-sm text-red-600"},oe={key:0,class:"mt-1 text-sm text-red-600"},ne={key:0,class:"mt-1 text-sm text-red-600"},le={key:0,class:"mt-1 text-sm text-red-600"},de={key:0,class:"mt-3 space-y-2"},ie={class:"truncate"},ue={class:"font-medium"},me={class:"ml-2 text-gray-500"},pe=["onClick"],ce={key:0,class:"mt-1 text-sm text-red-600"},ve={class:"grid grid-cols-1 md:grid-cols-2 gap-4"},fe={key:0,class:"mt-1 text-sm text-red-600"},ge={key:0,class:"mt-1 text-sm text-red-600"},be={key:0,class:"mt-1 text-sm text-red-600"},xe={class:"flex justify-end space-x-3 pt-6"},ye=["disabled"],ke={key:0,class:"inline-block w-4 h-4 border-2 border-white/70 border-t-transparent rounded-full animate-spin mr-2"},Ce={__name:"Create",props:{knowledgeList:{type:Array,default:()=>[]},tagList:{type:Array,default:()=>[]},user:{type:Object,default:()=>({})}},setup(D){const B=D,a=f({knowledge_id:"",version_number:"",title:"",description:"",content:"",tags:[],effective_date:"",expiry_date:"",change_notes:""}),s=f({}),g=f(!1),b=f([]),x=f(!1),C=f(null),S=T(()=>B.knowledgeList.map(o=>({value:o.id,label:o.title}))),U=T(()=>B.tagList.map(o=>({value:o.id,label:o.name})));function $(){x.value=!0}function E(){x.value=!1}function L(o){x.value=!1;const e=Array.from(o.dataTransfer.files);M(e)}function O(o){const e=Array.from(o.target.files);M(e)}function M(o){const m=["application/pdf","application/msword","application/vnd.openxmlformats-officedocument.wordprocessingml.document","application/vnd.ms-excel","application/vnd.openxmlformats-officedocument.spreadsheetml.sheet","image/jpeg","image/png"];o.forEach(r=>{if(!m.includes(r.type)){_.error(`File ${r.name} tidak didukung`);return}if(r.size>5242880){_.error(`File ${r.name} terlalu besar (maks 5MB)`);return}b.value.push(r)})}function z(o){b.value.splice(o,1)}function N(){g.value=!0,s.value={};const o=new FormData;Object.keys(a.value).forEach(e=>{e==="tags"?a.value[e].forEach(m=>{o.append("tags[]",m)}):o.append(e,a.value[e]||"")}),b.value.forEach((e,m)=>{o.append(`attachments[${m}]`,e)}),K.post(V("admin.knowledge-versions.store"),o,{onSuccess:()=>{_.success("Versi pengetahuan berhasil dibuat!")},onError:e=>{s.value=e,_.error("Gagal membuat versi pengetahuan!")},onFinish:()=>{g.value=!1}})}return(o,e)=>(n(),A(I,{"page-title":"Tambah Versi Pengetahuan",user:D.user},{default:w(()=>{var m;return[t("div",q,[t("div",H,[t("div",Q,[(m=o.$page.props.flash)!=null&&m.success?(n(),l("div",R,[t("div",W,[t("p",X,d(o.$page.props.flash.success),1)])])):i("",!0),t("div",Y,[y(k(j),{href:k(V)("admin.knowledge-versions.index"),class:"text-brand-700 hover:text-brand-800 mr-4"},{default:w(()=>e[10]||(e[10]=[t("svg",{class:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M15 19l-7-7 7-7"})],-1)])),_:1,__:[10]},8,["href"]),e[11]||(e[11]=t("div",{class:"flex-1"},[t("h1",{class:"text-3xl font-bold text-gray-900"},"Tambah Versi Pengetahuan Baru"),t("p",{class:"text-gray-600 mt-2"},"Buat versi baru untuk pengetahuan yang sudah ada")],-1)),e[12]||(e[12]=t("div",{class:"hidden md:flex items-center gap-3"},[t("span",{class:"inline-flex items-center rounded-full bg-brand-50 px-3 py-1 text-sm font-medium text-brand-700 border border-brand-100"},"Form")],-1))]),t("form",{onSubmit:h(N,["prevent"]),class:"space-y-6"},[t("div",Z,[t("div",ee,[t("div",te,[t("div",se,[t("div",null,[e[13]||(e[13]=t("label",{for:"knowledge_id",class:"block text-sm font-medium text-gray-700 mb-2"},[p("Pengetahuan "),t("span",{class:"text-red-500"},"*")],-1)),y(P,{modelValue:a.value.knowledge_id,"onUpdate:modelValue":e[0]||(e[0]=r=>a.value.knowledge_id=r),options:S.value,placeholder:"Pilih Pengetahuan...",class:u(s.value.knowledge_id?"border-red-500":"border-gray-300")},null,8,["modelValue","options","class"]),s.value.knowledge_id?(n(),l("div",re,d(s.value.knowledge_id),1)):i("",!0)]),t("div",null,[e[14]||(e[14]=t("label",{for:"version_number",class:"block text-sm font-medium text-gray-700 mb-2"},[p("Nomor Versi "),t("span",{class:"text-red-500"},"*")],-1)),c(t("input",{"onUpdate:modelValue":e[1]||(e[1]=r=>a.value.version_number=r),id:"version_number",type:"text",class:u(["w-full px-3 py-2 rounded-md focus:outline-none focus:ring-2 focus:ring-brand-500 border transition-colors",s.value.version_number?"border-red-500":"border-gray-300 hover:border-gray-400"]),placeholder:"Contoh: 1.0, 1.1, 2.0"},null,2),[[v,a.value.version_number]]),s.value.version_number?(n(),l("div",ae,d(s.value.version_number),1)):i("",!0)]),t("div",null,[e[15]||(e[15]=t("label",{for:"title",class:"block text-sm font-medium text-gray-700 mb-2"},[p("Judul "),t("span",{class:"text-red-500"},"*")],-1)),c(t("input",{"onUpdate:modelValue":e[2]||(e[2]=r=>a.value.title=r),id:"title",type:"text",class:u(["w-full px-3 py-2 rounded-md focus:outline-none focus:ring-2 focus:ring-brand-500 border transition-colors",s.value.title?"border-red-500":"border-gray-300 hover:border-gray-400"]),placeholder:"Masukkan judul versi pengetahuan"},null,2),[[v,a.value.title]]),s.value.title?(n(),l("div",oe,d(s.value.title),1)):i("",!0)]),t("div",null,[e[16]||(e[16]=t("label",{for:"description",class:"block text-sm font-medium text-gray-700 mb-2"},"Deskripsi Singkat",-1)),c(t("textarea",{"onUpdate:modelValue":e[3]||(e[3]=r=>a.value.description=r),id:"description",rows:"3",class:u(["w-full px-3 py-2 rounded-md focus:outline-none focus:ring-2 focus:ring-brand-500 border transition-colors",s.value.description?"border-red-500":"border-gray-300 hover:border-gray-400"]),placeholder:"Masukkan deskripsi singkat versi pengetahuan"},null,2),[[v,a.value.description]]),s.value.description?(n(),l("div",ne,d(s.value.description),1)):i("",!0)]),t("div",null,[e[17]||(e[17]=t("label",{for:"content",class:"block text-sm font-medium text-gray-700 mb-2"},[p("Konten "),t("span",{class:"text-red-500"},"*")],-1)),c(t("textarea",{"onUpdate:modelValue":e[4]||(e[4]=r=>a.value.content=r),id:"content",rows:"14",class:u(["w-full px-3 py-2 rounded-md focus:outline-none focus:ring-2 focus:ring-brand-500 border transition-colors resize-none",s.value.content?"border-red-500":"border-gray-300 hover:border-gray-400"]),placeholder:"Masukkan konten lengkap versi pengetahuan"},null,2),[[v,a.value.content]]),s.value.content?(n(),l("div",le,d(s.value.content),1)):i("",!0)]),t("div",null,[e[19]||(e[19]=t("label",{class:"block text-sm font-medium text-gray-700 mb-2"},"Lampiran",-1)),t("div",{class:u(["border-2 border-dashed rounded-lg p-4 text-center cursor-pointer bg-white hover:bg-gray-50",x.value?"border-brand-400 bg-brand-50/30":"border-gray-300"]),onDragover:h($,["prevent"]),onDragleave:h(E,["prevent"]),onDrop:h(L,["prevent"]),onClick:e[5]||(e[5]=()=>{var r;return(r=C.value)==null?void 0:r.click()})},[t("input",{ref_key:"fileInput",ref:C,type:"file",multiple:"",class:"hidden",onChange:O},null,544),e[18]||(e[18]=t("div",{class:"flex flex-col items-center gap-1 text-sm text-gray-600"},[t("svg",{class:"w-8 h-8 text-brand-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M4 16v1a3 3 0 003 3h10a3 3 0 003-3v-1M12 12l-2 2m0 0l-2-2m2 2V4"})]),t("span",null,[t("span",{class:"font-medium text-brand-700"},"Klik"),p(" atau seret file ke sini")]),t("span",{class:"text-xs text-gray-400"},"Dokumen (PDF, Office) atau Gambar (JPG/PNG). Total maks 5MB.")],-1))],34),b.value.length?(n(),l("ul",de,[(n(!0),l(G,null,J(b.value,(r,F)=>(n(),l("li",{key:F,class:"flex items-center justify-between bg-white border rounded px-3 py-2 text-sm"},[t("div",ie,[t("span",ue,d(r.name),1),t("span",me,"("+d((r.size/1024/1024).toFixed(2))+" MB)",1)]),t("button",{type:"button",onClick:he=>z(F),class:"text-red-600 hover:text-red-700"},"Hapus",8,pe)]))),128))])):i("",!0)]),t("div",null,[e[20]||(e[20]=t("label",{for:"tags",class:"block text-sm font-medium text-gray-700 mb-2"},"Tags",-1)),y(P,{modelValue:a.value.tags,"onUpdate:modelValue":e[6]||(e[6]=r=>a.value.tags=r),options:U.value,placeholder:"Pilih Tags...",multiple:"",class:u(s.value.tags?"border-red-500":"border-gray-300")},null,8,["modelValue","options","class"]),s.value.tags?(n(),l("div",ce,d(s.value.tags),1)):i("",!0)]),t("div",ve,[t("div",null,[e[21]||(e[21]=t("label",{for:"effective_date",class:"block text-sm font-medium text-gray-700 mb-2"},"Tanggal Efektif",-1)),c(t("input",{"onUpdate:modelValue":e[7]||(e[7]=r=>a.value.effective_date=r),id:"effective_date",type:"date",class:u(["w-full px-3 py-2 rounded-md focus:outline-none focus:ring-2 focus:ring-brand-500 border transition-colors",s.value.effective_date?"border-red-500":"border-gray-300 hover:border-gray-400"])},null,2),[[v,a.value.effective_date]]),s.value.effective_date?(n(),l("div",fe,d(s.value.effective_date),1)):i("",!0)]),t("div",null,[e[22]||(e[22]=t("label",{for:"expiry_date",class:"block text-sm font-medium text-gray-700 mb-2"},"Tanggal Kadaluarsa",-1)),c(t("input",{"onUpdate:modelValue":e[8]||(e[8]=r=>a.value.expiry_date=r),id:"expiry_date",type:"date",class:u(["w-full px-3 py-2 rounded-md focus:outline-none focus:ring-2 focus:ring-brand-500 border transition-colors",s.value.expiry_date?"border-red-500":"border-gray-300 hover:border-gray-400"])},null,2),[[v,a.value.expiry_date]]),s.value.expiry_date?(n(),l("div",ge,d(s.value.expiry_date),1)):i("",!0)])]),t("div",null,[e[23]||(e[23]=t("label",{for:"change_notes",class:"block text-sm font-medium text-gray-700 mb-2"},"Catatan Perubahan",-1)),c(t("textarea",{"onUpdate:modelValue":e[9]||(e[9]=r=>a.value.change_notes=r),id:"change_notes",rows:"3",class:u(["w-full px-3 py-2 rounded-md focus:outline-none focus:ring-2 focus:ring-brand-500 border transition-colors",s.value.change_notes?"border-red-500":"border-gray-300 hover:border-gray-400"]),placeholder:"Jelaskan perubahan yang dilakukan pada versi ini"},null,2),[[v,a.value.change_notes]]),s.value.change_notes?(n(),l("div",be,d(s.value.change_notes),1)):i("",!0)])])])])]),t("div",xe,[y(k(j),{href:k(V)("admin.knowledge-versions.index"),class:"px-4 py-2 border border-gray-300 rounded-md shadow-sm text-sm font-medium text-gray-700 bg-white hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-brand-500"},{default:w(()=>e[24]||(e[24]=[p(" Batal ",-1)])),_:1,__:[24]},8,["href"]),t("button",{type:"submit",disabled:g.value,class:"px-4 py-2 border border-transparent rounded-md shadow-sm text-sm font-medium text-white bg-brand-600 hover:bg-brand-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-brand-500 disabled:opacity-50"},[g.value?(n(),l("span",ke)):i("",!0),p(" "+d(g.value?"Menyimpan...":"Simpan Versi"),1)],8,ye)])],32)])])])]}),_:1},8,["user"]))}};export{Ce as default};
