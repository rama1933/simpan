import{_ as R}from"./AdminLayout-BSzZtYi4.js";import{n as T,r as M,c as L,o as u,w as l,a as e,b,e as G,i as o,t as B,u as n,l as P,j as d,p as x,F as I,k as J,y as E,x as w}from"./app-Csu41_Kp.js";import{c as Q,f as W,d as g,a as X,F as Y,e as c,E as p}from"./index.esm-BPJd59vU.js";import{_ as Z}from"./VueSelect.vue_vue_type_script_setup_true_lang-CDBjgkUk.js";import{r as S}from"./route-B4Jpo0AN.js";import"./sidebar.esm-CutvFG-v.js";const ee={class:"min-h-screen bg-gray-50"},se={class:"w-full mx-auto py-6 px-6"},ae={class:"px-0"},te={key:0,class:"mb-4"},re={class:"rounded-md bg-green-50 p-4 border border-green-200"},oe={class:"text-sm font-medium text-green-800"},ne={class:"mb-6 flex items-center justify-between"},le={class:"grid grid-cols-1 gap-6"},ie={class:"space-y-6"},de={class:"bg-white shadow rounded-lg p-6"},me={class:"space-y-6"},ue={class:"relative"},ce={class:"relative"},pe={class:"grid grid-cols-1 md:grid-cols-2 gap-6"},fe={class:"relative"},be={class:"relative"},ge={class:"flex flex-wrap gap-2"},xe=["value","checked","onChange"],ve={class:"sticky bottom-0 inset-x-0 bg-white/95 backdrop-blur supports-[backdrop-filter]:bg-white/80 border-t border-gray-200 px-6 py-4 flex justify-end gap-3 shadow-lg"},he=["disabled"],ye={key:0},we={key:1},Be={__name:"Edit",props:{user:Object,editing:Object,roles:Array,skpds:Array},setup(v){var _,k,V,C;const m=v,z=T(()=>(m.skpds||[]).map(a=>({id:a.id,nama_skpd:a.nama_skpd}))),F={name:((_=m.editing)==null?void 0:_.name)||"",email:((k=m.editing)==null?void 0:k.email)||"",password:"",password_confirmation:"",skpd_id:((V=m.editing)==null?void 0:V.skpd_id)||null,roles:(((C=m.editing)==null?void 0:C.roles)||[]).map(a=>a.name)},$=Q({name:g().required("Nama wajib diisi").max(255),email:g().required("Email wajib diisi").email("Format email tidak valid").max(255),password:g().nullable().test("password-length","Minimal 8 karakter",function(a){return a?a.length>=8:!0}),password_confirmation:g().nullable().test("password-match","Konfirmasi password tidak sama",function(a){const s=this.parent.password;return!s&&!a?!0:a===s}),skpd_id:X().required("SKPD wajib dipilih"),roles:W().of(g()).ensure().min(1,"Minimal pilih 1 role").default([])}),U=M(null),f=M(!1),D=(a,s)=>f.value||!s,H=async a=>{try{f.value=!0;const s={name:a.name,email:a.email,skpd_id:a.skpd_id,roles:a.roles||[],_method:"PUT"};a.password&&a.password.trim()!==""&&(s.password=a.password,s.password_confirmation=a.password_confirmation),E.post(S("users.update",m.editing.id),s,{onSuccess:()=>{w.success("User berhasil diperbarui"),E.visit(S("users.index"))},onError:()=>{w.error("Gagal memperbarui user")},onFinish:()=>{f.value=!1}})}catch{f.value=!1,w.error("Terjadi kesalahan")}};return(a,s)=>(u(),L(R,{"page-title":"Edit User",user:v.user},{default:l(()=>{var j;return[e("div",ee,[e("div",se,[e("div",ae,[(j=a.$page.props.flash)!=null&&j.success?(u(),b("div",te,[e("div",re,[e("p",oe,B(a.$page.props.flash.success),1)])])):G("",!0),e("div",ne,[o(n(P),{href:"/users",class:"text-brand-700 hover:text-brand-800 mr-4"},{default:l(()=>s[0]||(s[0]=[e("svg",{class:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M15 19l-7-7 7-7"})],-1)])),_:1,__:[0]}),s[1]||(s[1]=e("div",{class:"flex-1"},[e("h1",{class:"text-3xl font-bold text-gray-900"},"Edit User"),e("p",{class:"text-gray-600 mt-2"},"Perbarui data user dalam sistem manajemen pengetahuan")],-1)),s[2]||(s[2]=e("div",{class:"hidden md:flex items-center gap-3"},[e("span",{class:"inline-flex items-center rounded-full bg-brand-50 px-3 py-1 text-sm font-medium text-brand-700 border border-brand-100"},"Form")],-1))]),o(n(Y),{ref_key:"formRef",ref:U,"validation-schema":n($),"initial-values":F,onSubmit:H,class:"space-y-6"},{default:l(({meta:K,values:N})=>[e("div",le,[e("div",ie,[e("div",de,[e("div",me,[e("div",null,[s[4]||(s[4]=e("label",{for:"name",class:"block text-sm font-medium text-gray-700 mb-2"},[d("Nama "),e("span",{class:"text-red-500"},"*")],-1)),o(n(c),{name:"name"},{default:l(({field:t,meta:r})=>[e("div",ue,[s[3]||(s[3]=e("div",{class:"pointer-events-none absolute inset-y-0 left-0 flex items-center pl-3"},[e("svg",{class:"h-5 w-5 text-gray-400",viewBox:"0 0 20 20",fill:"currentColor"},[e("path",{"fill-rule":"evenodd",d:"M10 9a3 3 0 100-6 3 3 0 000 6zm-7 9a7 7 0 1114 0H3z","clip-rule":"evenodd"})])],-1)),e("input",x(t,{id:"name",type:"text",class:["w-full pl-10 pr-24 py-2 rounded-md focus:outline-none focus:ring-2 focus:ring-brand-500 border transition-colors",r.touched&&!r.valid?"border-red-500":"border-gray-300 hover:border-gray-400"],placeholder:"Masukkan nama lengkap",maxlength:"255"}),null,16)])]),_:2},1024),o(n(p),{name:"name",class:"mt-1 text-sm text-red-600"})]),e("div",null,[s[6]||(s[6]=e("label",{for:"email",class:"block text-sm font-medium text-gray-700 mb-2"},[d("Email "),e("span",{class:"text-red-500"},"*")],-1)),o(n(c),{name:"email"},{default:l(({field:t,meta:r})=>[e("div",ce,[s[5]||(s[5]=e("div",{class:"pointer-events-none absolute inset-y-0 left-0 flex items-center pl-3"},[e("svg",{class:"h-5 w-5 text-gray-400",viewBox:"0 0 20 20",fill:"currentColor"},[e("path",{d:"M2.003 5.884L10 9.882l7.997-3.998A2 2 0 0016 4H4a2 2 0 00-1.997 1.884z"}),e("path",{d:"M18 8.118l-8 4-8-4V14a2 2 0 002 2h12a2 2 0 002-2V8.118z"})])],-1)),e("input",x(t,{id:"email",type:"email",class:["w-full pl-10 pr-24 py-2 rounded-md focus:outline-none focus:ring-2 focus:ring-brand-500 border transition-colors",r.touched&&!r.valid?"border-red-500":"border-gray-300 hover:border-gray-400"],placeholder:"user@example.com",maxlength:"255"}),null,16)])]),_:2},1024),o(n(p),{name:"email",class:"mt-1 text-sm text-red-600"})]),e("div",pe,[e("div",null,[s[8]||(s[8]=e("label",{for:"password",class:"block text-sm font-medium text-gray-700 mb-2"},[d("Password "),e("span",{class:"text-gray-500"},"(opsional)")],-1)),o(n(c),{name:"password"},{default:l(({field:t,meta:r})=>[e("div",fe,[s[7]||(s[7]=e("div",{class:"pointer-events-none absolute inset-y-0 left-0 flex items-center pl-3"},[e("svg",{class:"h-5 w-5 text-gray-400",viewBox:"0 0 20 20",fill:"currentColor"},[e("path",{"fill-rule":"evenodd",d:"M5 9V7a5 5 0 0110 0v2a2 2 0 012 2v5a2 2 0 01-2 2H5a2 2 0 01-2-2v-5a2 2 0 012-2zm8-2v2H7V7a3 3 0 016 0z","clip-rule":"evenodd"})])],-1)),e("input",x(t,{id:"password",type:"password",class:["w-full pl-10 pr-24 py-2 rounded-md focus:outline-none focus:ring-2 focus:ring-brand-500 border transition-colors",r.touched&&!r.valid?"border-red-500":"border-gray-300 hover:border-gray-400"],placeholder:"Kosongkan jika tidak ingin mengubah"}),null,16)])]),_:2},1024),o(n(p),{name:"password",class:"mt-1 text-sm text-red-600"})]),e("div",null,[s[10]||(s[10]=e("label",{for:"password_confirmation",class:"block text-sm font-medium text-gray-700 mb-2"},"Konfirmasi Password",-1)),o(n(c),{name:"password_confirmation"},{default:l(({field:t,meta:r})=>[e("div",be,[s[9]||(s[9]=e("div",{class:"pointer-events-none absolute inset-y-0 left-0 flex items-center pl-3"},[e("svg",{class:"h-5 w-5 text-gray-400",viewBox:"0 0 20 20",fill:"currentColor"},[e("path",{"fill-rule":"evenodd",d:"M5 9V7a5 5 0 0110 0v2a2 2 0 012 2v5a2 2 0 01-2 2H5a2 2 0 01-2-2v-5a2 2 0 012-2zm8-2v2H7V7a3 3 0 016 0z","clip-rule":"evenodd"})])],-1)),e("input",x(t,{id:"password_confirmation",type:"password",class:["w-full pl-10 pr-24 py-2 rounded-md focus:outline-none focus:ring-2 focus:ring-brand-500 border transition-colors",r.touched&&!r.valid?"border-red-500":"border-gray-300 hover:border-gray-400"],placeholder:"Ulangi password"}),null,16)])]),_:2},1024),o(n(p),{name:"password_confirmation",class:"mt-1 text-sm text-red-600"})])]),e("div",null,[s[11]||(s[11]=e("label",{class:"block text-sm font-medium text-gray-700 mb-2"},[d("SKPD "),e("span",{class:"text-red-500"},"*")],-1)),o(n(c),{name:"skpd_id"},{default:l(({field:t})=>[o(Z,{modelValue:t.value,"onUpdate:modelValue":r=>t.value=r,options:z.value,placeholder:"Pilih SKPD",onChange:r=>t.onChange(r)},null,8,["modelValue","onUpdate:modelValue","options","onChange"])]),_:1}),o(n(p),{name:"skpd_id",class:"mt-1 text-sm text-red-600"})]),e("div",null,[s[12]||(s[12]=e("label",{class:"block text-sm font-medium text-gray-700 mb-2"},[d("Roles "),e("span",{class:"text-red-500"},"*")],-1)),o(n(c),{name:"roles"},{default:l(({field:t,meta:r})=>[e("div",ge,[(u(!0),b(I,null,J(v.roles,i=>(u(),b("label",{key:i.id,class:"inline-flex items-center gap-2 text-sm px-3 py-2 rounded-lg border border-brand-100 bg-brand-50 text-brand-800 hover:bg-brand-100 cursor-pointer transition-colors"},[e("input",{type:"checkbox",value:i.name,checked:t.value&&t.value.includes(i.name),onChange:A=>{const h=A.target,q=!!(h!=null&&h.checked),y=Array.isArray(t.value)?t.value:[];q?y.includes(i.name)||t.onChange([...y,i.name]):t.onChange(y.filter(O=>O!==i.name))},class:"rounded border-gray-300 text-brand-700 focus:ring-brand-500"},null,40,xe),d(" "+B(i.name),1)]))),128))])]),_:2},1024),o(n(p),{name:"roles",class:"mt-1 text-sm text-red-600"})])])])])]),e("div",ve,[o(n(P),{href:"/users",class:"px-4 py-2 border border-gray-300 rounded-md text-sm font-medium text-gray-700 bg-white hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-brand-500"},{default:l(()=>s[13]||(s[13]=[d("Batal",-1)])),_:1,__:[13]}),e("button",{type:"submit",disabled:D(N,K.valid),class:"px-5 py-2.5 border border-transparent rounded-md shadow-sm text-sm font-semibold text-white bg-brand-700 hover:bg-brand-800 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-brand-500 disabled:opacity-50 disabled:cursor-not-allowed"},[f.value?(u(),b("span",ye,"Menyimpan...")):(u(),b("span",we,"Simpan Perubahan"))],8,he)])]),_:1},8,["validation-schema"])])])])]}),_:1},8,["user"]))}};export{Be as default};
